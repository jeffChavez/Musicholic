<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Platform Development Guidelines| iOS">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Advanced Implementations</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/BookStyles.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../index.html#mobile/mobile_ios/i_Advanced Implementations.html">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><span class="MCBreadcrumbsSelf">Platform Development Guidelines</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="MobileiOSImplementationGuide.html"> iOS</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Advanced Implementations</span>
        </div>
        <h1>Advanced Implementations</h1>
        <h2>User History</h2>
        <p>The sample application includes a user history feature. It stores the results of certain operations and allows the user to view them. When viewed, the history record displays the recognized music, including cover art and the location of the user when the operation occurred.</p>
        <p>The feature uses a local SQLite database to store the user history information.</p>
        <h3>Adding Entries</h3>
        <p>When results for an appropriate operation are received, an entry is added to the database. Only results from the following operations are stored:</p>
        <ul>
            <li value="1">Recognizing music from the microphone (IDNow)</li>
            <li value="2">Recognizing music from a PCM sample (AlbumID)</li>
            <li value="3">Searching by fingerprint</li>
        </ul>
        <p>The process of adding an entry to the database is included in the search operation classes. This allows it to be called in the thread that invokes callbacks for any of the operations mentioned above. Before adding an entry, a check is made to ensure the database exists, and if it doesn’t, it is created.</p>
        <p>Each record in the database contains a unique ID. The ID is generated by incrementing the ID of the last entry added to the database. IDs are later used by the mechanism that prunes the database, keeping it within a predetermined size.</p>
        <p>A single synchronized method is used to add an entry to the database. Synchronization is essential to guarantee the integrity of the mechanism used to generate unique IDs and the procedure used to create a database if it doesn’t already exist.</p>
        <h3>Limiting Database Size</h3>
        <p>The size of the database cannot be allowed to grow indefinitely. After adding an entry to the database, its size is checked to determine if it exceeds a predefined limit of 1000 entries. If there are more than 1000 entries, the oldest entries in the database are deleted, bringing the size back to the predetermined limit.</p>
        <h3>Recalling Entries</h3>
        <p>The sample application exports a mutable copy of the entries in the database in an array. The data contained within the export can then be used to populate a UI that allows the user to navigate the entries. For large databases, a paging mechanism can be used to reduce the number of entries exported into memory at any one time.</p>
        <p class="onlineFooter">© 2000 to present. Gracenote, Inc. All rights reserved.</p>
        <p><a href="mailto:doc_feedback@gracenote.com?subject=Gracenote Documentation Feedback" target="_blank" title="Send comments about this topic to Gracenote Technical Publications." alt="Send comments about this topic to Gracenote Technical Publications.">How can we improve this documentation?</a>
        </p>
    </body>
</html>